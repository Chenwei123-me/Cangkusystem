<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<%@ page language="java" contentType="text/html; charset=UTF-8" pageEncoding="UTF-8"%>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=gb2312" />
  <meta name="keywords" content="百度地图,百度地图API，百度地图自定义工具，百度地图所见即所得工具" />
  <meta name="description" content="百度地图API自定义地图，帮助用户在可视化操作下生成百度地图" />
  <title>百度地图API自定义地图</title>
  <!--引用百度地图API-->
  <style type="text/css">
    html,body{margin:0;padding:0;}
    .iw_poi_title {color:#CC5522;font-size:14px;font-weight:bold;overflow:hidden;padding-right:13px;white-space:nowrap}
    .iw_poi_content {font:12px arial,sans-serif;overflow:visible;padding-top:4px;white-space:-moz-pre-wrap;word-wrap:break-word}
  </style>
  <script type="text/javascript" src="http://api.map.baidu.com/api?key=&v=1.1&services=true"></script>
</head>

<body>
<!--百度地图容器-->
<div style="width:697px;height:550px;border:#ccc solid 1px;" id="dituContent"></div>
</body>
<script type="text/javascript">
  //创建和初始化地图函数：
  function initMap(){
    createMap();//创建地图
    setMapEvent();//设置地图事件
    addMapControl();//向地图添加控件
    addMarker();//向地图中添加marker
    addPolyline();//向地图中添加线
    addRemark();//向地图中添加文字标注
  }

  //创建地图函数：
  function createMap(){
    var map = new BMap.Map("dituContent");//在百度地图容器中创建一个地图
    var point = new BMap.Point(114.289599,24.017375);//定义一个中心点坐标
    map.centerAndZoom(point,10);//设定地图的中心点和坐标并将地图显示在地图容器中
    window.map = map;//将map变量存储在全局
  }

  //地图事件设置函数：
  function setMapEvent(){
    map.enableDragging();//启用地图拖拽事件，默认启用(可不写)
    map.enableScrollWheelZoom();//启用地图滚轮放大缩小
    map.enableDoubleClickZoom();//启用鼠标双击放大，默认启用(可不写)
    map.enableKeyboard();//启用键盘上下左右键移动地图
  }

  //地图控件添加函数：
  function addMapControl(){
    //向地图中添加缩放控件
    var ctrl_nav = new BMap.NavigationControl({anchor:BMAP_ANCHOR_TOP_LEFT,type:BMAP_NAVIGATION_CONTROL_LARGE});
    map.addControl(ctrl_nav);
    //向地图中添加缩略图控件
    var ctrl_ove = new BMap.OverviewMapControl({anchor:BMAP_ANCHOR_BOTTOM_RIGHT,isOpen:1});
    map.addControl(ctrl_ove);
    //向地图中添加比例尺控件
    var ctrl_sca = new BMap.ScaleControl({anchor:BMAP_ANCHOR_BOTTOM_LEFT});
    map.addControl(ctrl_sca);
  }

  //标注点数组
  var markerArr = [{title:"温泉收费站",content:"温泉收费站",point:"113.672065|23.644342",isOpen:0,icon:{w:21,h:21,l:0,t:0,x:6,lb:5}}
    ,{title:"米埗收费站",content:"米埗收费站",point:"113.671373|23.699917",isOpen:0,icon:{w:21,h:21,l:0,t:0,x:6,lb:5}}
    ,{title:"良口收费站",content:"良口收费站",point:"113.724226|23.729159",isOpen:0,icon:{w:21,h:21,l:0,t:0,x:6,lb:5}}
    ,{title:"吕田收费站",content:"吕田收费站",point:"113.940323|23.833777",isOpen:0,icon:{w:21,h:21,l:0,t:0,x:6,lb:5}}
    ,{title:"地派收费站",content:"新丰收费站",point:"114.186668|24.021169",isOpen:0,icon:{w:21,h:21,l:0,t:0,x:6,lb:5}}
    ,{title:"连平南收费站",content:"连平南收费站",point:"114.495489|24.329871",isOpen:0,icon:{w:21,h:21,l:0,t:0,x:6,lb:5}}
    ,{title:"上坪收费站",content:"上坪收费站",point:"114.596925|24.499914",isOpen:0,icon:{w:21,h:21,l:0,t:0,x:6,lb:5}}
  ];
  //创建marker
  function addMarker(){
    for(var i=0;i<markerArr.length;i++){
      var json = markerArr[i];
      var p0 = json.point.split("|")[0];
      var p1 = json.point.split("|")[1];
      var point = new BMap.Point(p0,p1);
      var iconImg = createIcon(json.icon);
      var marker = new BMap.Marker(point,{icon:iconImg});
      var iw = createInfoWindow(i);
      var label = new BMap.Label(json.title,{"offset":new BMap.Size(json.icon.lb-json.icon.x+10,-20)});
      marker.setLabel(label);
      map.addOverlay(marker);
      label.setStyle({
        borderColor:"#808080",
        color:"#333",
        cursor:"pointer"
      });

      (function(){
        var index = i;
        var _iw = createInfoWindow(i);
        var _marker = marker;
        _marker.addEventListener("click",function(){
          this.openInfoWindow(_iw);
        });
        _iw.addEventListener("open",function(){
          _marker.getLabel().hide();
        })
        _iw.addEventListener("close",function(){
          _marker.getLabel().show();
        })
        label.addEventListener("click",function(){
          _marker.openInfoWindow(_iw);
        })
        if(!!json.isOpen){
          label.hide();
          _marker.openInfoWindow(_iw);
        }
      })()
    }
  }
  //创建InfoWindow
  function createInfoWindow(i){
    var json = markerArr[i];
    var iw = new BMap.InfoWindow("<b class='iw_poi_title' title='" + json.title + "'>" + json.title + "</b><div class='iw_poi_content'>"+json.content+"</div>");
    return iw;
  }
  //创建一个Icon
  function createIcon(json){
    var icon = new BMap.Icon("http://app.baidu.com/map/images/us_mk_icon.png", new BMap.Size(json.w,json.h),{imageOffset: new BMap.Size(-json.l,-json.t),infoWindowOffset:new BMap.Size(json.lb+5,1),offset:new BMap.Size(json.x,json.h)})
    return icon;
  }
  //标注线数组
  var plPoints = [{style:"solid",weight:4,color:"#f00",opacity:0.6,points:["114.620945|24.568446","114.625688|24.560887","114.62576|24.560821"]}
    ,{style:"solid",weight:5,color:"#000",opacity:0.6,points:["113.974884|23.847038","113.975028|23.847071"]}
    ,{style:"solid",weight:5,color:"#f00",opacity:0.6,points:["113.978288|23.855598","113.982313|23.856176","113.983076|23.85635","113.986041|23.857209","113.989634|23.85825","113.991682|23.858457","113.993982|23.858415","113.996335|23.857969","114.001303|23.856292","114.004169|23.855168","114.007519|23.854416","114.010412|23.854292","114.011418|23.854458","114.014553|23.855152","114.019287|23.857482","114.022108|23.858291","114.02456|23.858225","114.028674|23.858267","114.032115|23.858771","114.035412|23.860126","114.036705|23.860762","114.040155|23.862389","114.043398|23.863084","114.047215|23.864166","114.048617|23.864579","114.051761|23.865983","114.052839|23.866661","114.057223|23.870395","114.061247|23.874641","114.065397|23.876723","114.06696|23.877434","114.069709|23.879598","114.070823|23.881663","114.071577|23.883497","114.073123|23.888883","114.074003|23.892732","114.073913|23.895838","114.072925|23.902033","114.073338|23.904378","114.07465|23.907583","114.075225|23.90935","114.075314|23.910275","114.075386|23.914586","114.075728|23.916915","114.076877|23.919789","114.078045|23.921788","114.080291|23.924265","114.086202|23.928824","114.091466|23.932878","114.096586|23.93718","114.098365|23.939129","114.100916|23.942332","114.107905|23.951216","114.108821|23.952224","114.112684|23.955345","114.115523|23.956831","114.127111|23.960414","114.132536|23.962098","114.137926|23.963683","114.14107|23.964541","114.144933|23.96649","114.147772|23.968719","114.150916|23.97283","114.154653|23.978113","114.15609|23.98082","114.156485|23.984237","114.156629|23.986301","114.157132|23.988232","114.157959|23.989586","114.159001|23.990791","114.161857|23.99325","114.163169|23.994769","114.164696|23.998252","114.165953|24.001009","114.166465|24.002246","114.167373|24.004194","114.167409|24.004211","114.168235|24.005333","114.169771|24.007025","114.17226|24.008626","114.173903|24.009311","114.17862|24.010474","114.181135|24.011201","114.184297|24.012397","114.185743|24.013338","114.187764|24.015252","114.189669|24.018388","114.191169|24.020847","114.192534|24.022242","114.195193|24.024907","114.198876|24.028348","114.201454|24.029883","114.209476|24.031459","114.21289|24.032242","114.215782|24.03348","114.21898|24.035625","114.222187|24.037102","114.224855|24.03782","114.230524|24.038851","114.235446|24.04079","114.238141|24.042325","114.240863|24.044346","114.244717|24.047333","114.24981|24.051202","114.253134|24.053776","114.254742|24.055813","114.25564|24.058519","114.255694|24.061175","114.255011|24.064871","114.255182|24.067255","114.255829|24.069235","114.257679|24.071792","114.25873|24.073318","114.259629|24.075107","114.260464|24.078209","114.260635|24.079933","114.260985|24.082894","114.261866|24.085978","114.262997|24.08804","114.265477|24.091207","114.267588|24.092807","114.269519|24.094192","114.272564|24.096543","114.27622|24.100592","114.278996|24.102233","114.282823|24.103396","114.285195|24.104517","114.288419|24.106991","114.290315|24.108063","114.293854|24.109102","114.296217|24.109737","114.299028|24.111271","114.300538|24.112466","114.3029|24.115814","114.306233|24.120564","114.308919|24.124802","114.309215|24.126673","114.309431|24.129402","114.30785|24.136163","114.307329|24.139567","114.307976|24.143417","114.309691|24.146797","114.312386|24.151125","114.313985|24.153829","114.316402|24.157942","114.31827|24.162715","114.319887|24.168501","114.321396|24.173462","114.323606|24.177451","114.324972|24.179825","114.325394|24.181696","114.325493|24.18552","114.325016|24.188017","114.324406|24.19142","114.324495|24.193562","114.324765|24.195046","114.32631|24.199784","114.327334|24.202668","114.328673|24.206277","114.330074|24.210141","114.331556|24.212951","114.333281|24.215159","114.335724|24.217145","114.338311|24.218743","114.343539|24.222047","114.348875|24.225424","114.351427|24.22666","114.35334|24.227344","114.355343|24.227748","114.358999|24.228135","114.361676|24.22853","114.364919|24.229494","114.370345|24.232064","114.376417|24.234981","114.38161|24.237518","114.385041|24.239553","114.38814|24.241999","114.390835|24.245006","114.393252|24.247296","114.395956|24.249174","114.397752|24.249833","114.398749|24.250195","114.402226|24.251043","114.403088|24.251274","114.405972|24.252287","114.410032|24.254264","114.412934|24.256479","114.415116|24.258572","114.417892|24.262228","114.420237|24.265638","114.423013|24.269402","114.424342|24.270868","114.426597|24.272506","114.429103|24.273676","114.436236|24.275249","114.440188|24.276212","114.444249|24.277942","114.44803|24.280313","114.450204|24.282174","114.453797|24.285756","114.45872|24.290648","114.460831|24.292459","114.464308|24.294583","114.469868|24.297004","114.472752|24.298256","114.475339|24.299762","114.4778|24.302315","114.478923|24.304546","114.480127|24.30788","114.480935|24.309634","114.482211|24.311577","114.483576|24.312985","114.48505|24.314072","114.488876|24.316031","114.491077|24.317677","114.492676|24.319521","114.493682|24.321044","114.494787|24.322888","114.496736|24.325951","114.498533|24.328223","114.502243|24.331779","114.505324|24.333985","114.509169|24.336067","114.512196|24.337565","114.513382|24.338388","114.516347|24.340866","114.517065|24.341812","114.5187|24.343903","114.520003|24.346298","114.52047|24.347467","114.521341|24.350249","114.521647|24.351837","114.521763|24.35438","114.521781|24.355113","114.521323|24.358569","114.520416|24.361343","114.519428|24.363482","114.51782|24.367119","114.515924|24.370913","114.515098|24.373678","114.514819|24.376961","114.515143|24.38073","114.51526|24.385469","114.515619|24.388382","114.516302|24.390751","114.516966|24.392709","114.517954|24.394659","114.521152|24.399505","114.523362|24.402681","114.525824|24.406679","114.527036|24.409278","114.529067|24.413869","114.529884|24.415399","114.532759|24.419092","114.537017|24.423846","114.539936|24.427021","114.541643|24.429217","114.544913|24.432762","114.548308|24.436315","114.551946|24.439219","114.555611|24.441859","114.559537|24.444194","114.564487|24.446892","114.568529|24.449351","114.570981|24.451694","114.573784|24.455074","114.575823|24.457418","114.577413|24.459367","114.578482|24.461217","114.579192|24.462903","114.579776|24.465443","114.579866|24.466282","114.580009|24.469267","114.579884|24.473181","114.579812|24.477941","114.579596|24.484181","114.579623|24.487791","114.579965|24.489632","114.580468|24.491375","114.581581|24.493364","114.583109|24.495313","114.58592|24.497697","114.588795|24.49925","114.590879|24.499834","114.594616|24.501157","114.59705|24.50244","114.599305|24.504035","114.601281|24.505711","114.604327|24.508325","114.607129|24.510791","114.60924|24.512665","114.611504|24.515575","114.613139|24.519553","114.614361|24.522816","114.615106|24.524221","114.618089|24.52769","114.618924|24.528577","114.620119|24.530665","114.620972|24.533254","114.622778|24.539253","114.62408|24.543616","114.625976|24.549927","114.626605|24.55254","114.626658|24.554027","114.626631|24.557026","114.625733|24.560732","114.625302|24.561192"]}
    ,{style:"solid",weight:4,color:"#f00",opacity:0.6,points:["113.974812|23.854226","113.977875|23.855515","113.978297|23.855631"]}
    ,{style:"solid",weight:4,color:"#f00",opacity:0.6,points:["113.974821|23.854226","113.971542|23.852367","113.970303|23.851921","113.966359|23.850673","113.964239|23.849682","113.960179|23.846649","113.957618|23.845112","113.956433|23.8446","113.95398|23.843716","113.953262|23.843526","113.952408|23.843352","113.951187|23.843096","113.945357|23.84184","113.942734|23.841295","113.940434|23.840559","113.938134|23.839477","113.935502|23.837659","113.934828|23.836882","113.933472|23.835502","113.932134|23.834337","113.930031|23.83313","113.926564|23.831874","113.925163|23.831709","113.920635|23.831122","113.917797|23.830304","113.914895|23.829089","113.911257|23.827189","113.910377|23.826668","113.907834|23.825808","113.904529|23.825139","113.897252|23.82385","113.893336|23.823023","113.891306|23.822412","113.889141|23.821296","113.885583|23.818742","113.884326|23.818147","113.882331|23.817577","113.878118|23.817064","113.874085|23.815833","113.871974|23.815461","113.869567|23.815519","113.864428|23.816461","113.860539|23.81642","113.858661|23.816081","113.856056|23.81513","113.852831|23.813717","113.850972|23.813172","113.848591|23.812973","113.846426|23.813362","113.844396|23.813924","113.84109|23.815659","113.838656|23.816701","113.836689|23.817155","113.833544|23.818312","113.830607|23.820222","113.829538|23.820858","113.828083|23.821445","113.825235|23.822122","113.82325|23.821982","113.822235|23.821841","113.820528|23.821329","113.819342|23.820858","113.817968|23.81999","113.81724|23.819354","113.814779|23.816965","113.8123|23.815296","113.811042|23.814709","113.808347|23.813874","113.803173|23.812519","113.799526|23.811535","113.797666|23.810841","113.795241|23.809403","113.793067|23.807196","113.791459|23.805799","113.789528|23.804848","113.786815|23.803765","113.784425|23.80284","113.779925|23.801145","113.778793|23.800715","113.776781|23.799484","113.776008|23.798789","113.774813|23.79731","113.773834|23.795136","113.773232|23.792557","113.772532|23.789366","113.771687|23.785621","113.770807|23.783025","113.769693|23.781082","113.768049|23.778949","113.766989|23.777693","113.765785|23.775667","113.76477|23.773617","113.764034|23.77002","113.764186|23.767895","113.763899|23.762289","113.762839|23.757138","113.761797|23.755195","113.759273|23.752359","113.756784|23.75068","113.752544|23.749158","113.751808|23.749026","113.748709|23.747587","113.747478|23.746636","113.744702|23.743428","113.743031|23.741765","113.739743|23.73964","113.738064|23.738548","113.736644|23.737291","113.735198|23.736043","113.733204|23.73438","113.732018|23.73371","113.729691|23.732668","113.723592|23.731031","113.720861|23.729708","113.717843|23.727921","113.71425|23.72673","113.711303|23.726068","113.709147|23.725473","113.707854|23.72501","113.706416|23.724348","113.705338|23.723885","113.703039|23.722892","113.699805|23.722098","113.69693|23.721635","113.693912|23.721304","113.691325|23.721106","113.690319|23.720775","113.68854|23.720171","113.686645|23.719419","113.685504|23.718658","113.68377|23.717392","113.681839|23.715556","113.680446|23.713529","113.679853|23.712429","113.679395|23.71118","113.678686|23.709278","113.67794|23.707135","113.677096|23.705489","113.67626|23.703942","113.675721|23.703272","113.674868|23.702172","113.674239|23.70156","113.673646|23.700956","113.67308|23.700369","113.672182|23.699566","113.671715|23.698904","113.671176|23.698383","113.670673|23.697887","113.670089|23.697258","113.669622|23.696886","113.669235|23.696282","113.668804|23.695653"]}
    ,{style:"solid",weight:4,color:"#f00",opacity:0.6,points:["113.668831|23.695686","113.667726|23.693113","113.667223|23.690797","113.667583|23.688547","113.667942|23.686561","113.668876|23.683847","113.670026|23.681465","113.671966|23.677162","113.673691|23.672264","113.675128|23.668822","113.675416|23.664254","113.674841|23.660084","113.672829|23.655847","113.672685|23.655053","113.672254|23.654258","113.671248|23.64916","113.671032|23.64393","113.66981|23.639626","113.666505|23.63572","113.663846|23.632211","113.662193|23.627509","113.660468|23.623536","113.659031|23.620623","113.656659|23.61857","113.655725|23.617709","113.655366|23.617444","113.654072|23.616782","113.648682|23.614","113.646526|23.611948","113.642358|23.609232","113.635531|23.606186","113.625686|23.602874","113.617349|23.60049","113.611888|23.598371","113.60851|23.596847","113.604917|23.594198","113.601539|23.591615","113.597658|23.58976","113.589394|23.588171","113.58386|23.587972","113.578255|23.586978","113.569631|23.582209","113.563595|23.576115","113.560433|23.570021","113.560433|23.57055"]}
  ];
  //向地图中添加线函数
  function addPolyline(){
    for(var i=0;i<plPoints.length;i++){
      var json = plPoints[i];
      var points = [];
      for(var j=0;j<json.points.length;j++){
        var p1 = json.points[j].split("|")[0];
        var p2 = json.points[j].split("|")[1];
        points.push(new BMap.Point(p1,p2));
      }
      var line = new BMap.Polyline(points,{strokeStyle:json.style,strokeWeight:json.weight,strokeColor:json.color,strokeOpacity:json.opacity});
      map.addOverlay(line);
    }
  }
  //文字标注数组
  var lbPoints = [{point:"114.281997|24.110815",content:"新丰收费站"}
    ,{point:"113.560594|23.573299",content:"从化收费站"}
    ,{point:"114.31236|24.125877",content:"码头收费站"}
    ,{point:"114.382542|24.23684",content:"隆街收费站"}
    ,{point:"114.513242|24.387627",content:"连平北收费站"}
  ];
  //向地图中添加文字标注函数
  function addRemark(){
    for(var i=0;i<lbPoints.length;i++){
      var json = lbPoints[i];
      var p1 = json.point.split("|")[0];
      var p2 = json.point.split("|")[1];
      var label = new BMap.Label("<div style='padding:2px;'>"+json.content+"</div>",{point:new BMap.Point(p1,p2),offset:new BMap.Size(3,-6)});
      map.addOverlay(label);
      label.setStyle({borderColor:"#999"});
    }
  }

  initMap();//创建和初始化地图
</script>
</html>